@if (!!object) {
<p-progressSpinner *ngIf="facades.size()" ariaLabel="loading" animationDuration="3"></p-progressSpinner>

<ng-container #formPrincipal>
    <div class="row mb-2">
        <div class="col-24" [ngClass]="{'col-16': objectUpdating()}">
            <combobox label="Projeto" compCtrl required [filterBy]="'id,subject,description,user.name'"
                [options]="projetos" [(ngModel)]="object.project" (onChange)="onChangeProject($event)"
                [disabled]="objectUpdating()">
            </combobox>
        </div>
        <div class="col-8" *ngIf="objectUpdating()">
            <combobox label="Status" compCtrl required disabled [(ngModel)]="object.status"
                [enum]="'SolicitationStatus'">
            </combobox>
        </div>
    </div>

    <div class="row mb-2">
        <div class="col-24">
            <combobox label="Responsável" compCtrl disabled [filterBy]="'id,name,email'"
                [options]="!!responsavel ? [responsavel] : []" [ngModel]="responsavel">
            </combobox>
        </div>
    </div>

    <div class="row mb-2">
        <div class="col-24">
            <combobox label="Natureza do Projeto" [(ngModel)]="object.projectNature"
                [disabled]="objectUpdating()" enum="SolicitationProjectNature" compCtrl required
                (onChange)="onChangeProjectNature()">
            </combobox>
        </div>
    </div>

    <div class="row mb-2" *ngIf="object.projectNature == OPCAO_OUTRO">
        <div class="ms-auto col-23">
            <input-text label="Outra Natureza" compCtrl required [(ngModel)]="object.otherProjectNature"
                [disabled]="objectUpdating()">
            </input-text>
        </div>
    </div>

    <div class="row mb-2">
        <div class="col-24">
            <combobox label="Formulário de Solicitação" [(ngModel)]="object.solicitationType"
                enum="SolicitationFormType" compCtrl required [disabled]="objectUpdating()"
                (onChange)="onChangeSolicitationType()">
            </combobox>
        </div>
    </div>

    <hr>

    <ng-container *ngIf="['AA'].includes(getSolicitationType())">
        <ng-container *ngTemplateOutlet="tableAA"></ng-container>
    </ng-container>

    <ng-container *ngIf="['AW', 'CLAE', 'COR', 'FTMIR'].includes(getSolicitationType())">
        <ng-container *ngTemplateOutlet="tableAmostrasSimples"></ng-container>
    </ng-container>

    <ng-container *ngIf="getSolicitationType() == 'AA'">
        <div class="row mb-2">
            <div class="col-24">
                <input-textarea label="Metodologia" compCtrl required [disabled]="disableForm"
                    [(ngModel)]="object.form.methodologyDescription" [maxlength]="255"
                    [placeholder]="'Descreva detalhadamente a metodologia de preparo que será adotada para as amostras a serem analisadas, incluindo todas as etapas que garantam a qualidade e a reprodutibilidade do processo.'">
                </input-textarea>
            </div>
        </div>

        <div class="row mb-2">
            <div class="col-24">
                <input-textarea label="Valores esperados de concentração das amostras" compCtrl required
                    [(ngModel)]="object.form.limitesConcentracao" [maxlength]="255"
                    [placeholder]="'Valores esperados de concentração das amostras.'">
                </input-textarea>
            </div>
        </div>

        <div class="row mb-2">
            <div class="col-24">
                <radio-button label="Forno" compCtrl required [(ngModel)]="object.form.forno" enum="AAForno"
                    [vertical]="false" [ignore]="'FG,GH'">
                </radio-button>
            </div>
        </div>

        <div class="row mb-2">
            <div class="col-24">
                <periodic-table label="Elementos para analisar" compCtrl required
                    [(ngModel)]="object.form.elementos">
                </periodic-table>
            </div>
        </div>

        <div class="row mb-2">
            <div class="col-24">
                <label class="form-label bold">Curva de concentrações padrões.</label>
            </div>
            <div class="col-12">
                <ul>
                    <li>Sódio - 0.1, 0.5, 1, 2.5, 5 ppm</li>
                    <li>Crômio - 1, 2.5, 5, 10, 15 e 20 ppm</li>
                    <li>Maganês - 0.1, 0.5, 1, 2.5, 5, 10, 15 e 20 ppm</li>
                </ul>
                <!-- <input-textarea label="Concentrações" compCtrl [(ngModel)]="object.form.curvaConcentracao"
                    [maxlength]="255"
                    [placeholder]="'Concentrações da curva de calibração.\nPadrão: 20; 15; 10; 5; 2,5; 1; 0,5 e 0,1 ppm (mg/L).'">
                </input-textarea>
                <b>Caso a faixa de concentração da amostra não estiver dentro desta faixa, o usuário
                    será responsável por trazer a curva em concentrações adequadas para cada elemento
                    analisado.
                </b> -->
            </div>
            <div class="col-12">
                <ul>
                    <li>Ferro - 1, 2.5, 5, 10, 15 e 20 ppm</li>
                    <li>Cobre - 0.5, 1, 2.5, 5, 10 e 15 ppm</li>
                    <li>Zinco - 0.1, 0.5, 1, 2.5, 5 e 10 ppm</li>
                </ul>
            </div>
        </div>

    </ng-container>

    <ng-container *ngIf="getSolicitationType() == 'CLAE'">
        <div class="row mb-2">
            <div class="col-24">
                <input-text label="Coluna" compCtrl required [(ngModel)]="object.form.coluna">
                </input-text>
            </div>
        </div>

        <div class="row mb-2">
            <div class="col-12">
                <input-number label="Fluxo (mL.min-1)" compCtrl required [(ngModel)]="object.form.fluxo"
                    [maxFractionDigits]="6" [maxlength]="15">
                </input-number>
            </div>
            <div class="col-12">
                <input-number label="Tempo de análise (min)" compCtrl required
                    [(ngModel)]="object.form.tempoAnalise" [maxFractionDigits]="2" [maxlength]="11">
                </input-number>
            </div>
        </div>

        <div class="row mb-2">
            <div class="col-12">
                <input-number label="Volume injetado (µL)" compCtrl required
                    [(ngModel)]="object.form.volumeInjetado" [maxFractionDigits]="6" [maxlength]="15">
                </input-number>
            </div>
            <div class="col-12">
                <input-number label="Temperatura do forno da coluna (°C)" compCtrl required
                    [(ngModel)]="object.form.temperaturaFornoColuna" [maxFractionDigits]="2" [maxlength]="11">
                </input-number>
            </div>
        </div>

        <hr>

        <h5 class="text-center mb-0">Detector(es) desejado(s):</h5>

        <div class="row mb-2">
            <div class="col-24">
                <checkbox [(ngModel)]="object.form.utilizaPDA" [label]="'PDA'" [disabled]="disableForm" />
            </div>
        </div>

        <div class="row mb-2" *ngIf="object.form.utilizaPDA">
            <div class="col-12">
                <input-number label="Comprimento de onda - Canal 1 (nm)" compCtrl required
                    [(ngModel)]="object.form.compOndaCanal1" [maxFractionDigits]="6" [maxlength]="15">
                </input-number>
            </div>
            <div class="col-12">
                <input-number label="Comprimento de onda - Canal 2 (nm)" compCtrl required
                    [(ngModel)]="object.form.compOndaCanal2" [maxFractionDigits]="6" [maxlength]="15">
                </input-number>
            </div>
        </div>

        <hr>

        <h5 class="text-center mb-0">Modo de eluição:</h5>

        <div class="row mb-2">
            <div class="col-24">
                <radio-button [(ngModel)]="object.form.modoEluicao" compCtrl="Modo de eluição" required
                    enum="CLAEModoEluicao" [vertical]="false">
                </radio-button>
            </div>
        </div>

        <div class="row mb-2" *ngIf="object.form.modoEluicao == MODO_ELUICAO_ISO">
            <div class="col-24">
                <input-text label="Composição da fase móvel" compCtrl required
                    [ngModel]="object.form.composicaoFaseMovel">
                </input-text>
            </div>
        </div>
        <div class="row mb-2" *ngIf="object.form.modoEluicao == MODO_ELUICAO_GRA">
            <div class="col-24 table-responsive">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th class="index-column">Nº</th>
                            <th *ngIf="!disableForm" class="button-column no-print"></th>
                            <th *ngIf="!disableForm" class="button-column no-print"></th>
                            <th>Tempo (min)</th>
                            <th>Fluxo (ml/min)</th>
                            <th>Solvente A (%)</th>
                            <th>Solvente B (%)</th>
                            <th class="button-column no-print">Total (%)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let gradiente of object.form.gradientes; let index = index">
                            <td>
                                <b>{{index +1}}</b>
                            </td>
                            <td *ngIf="!disableForm" class="button-column no-print">
                                <button class="btn btn-sm btn-success" (click)="onClickAddGradiente()">
                                    <i class="fa fa-plus"></i>
                                </button>
                            </td>
                            <td *ngIf="!disableForm" class="button-column no-print">
                                <button class="btn btn-sm btn-danger" (click)="onClickRemoveGradiente(index)">
                                    <i class="fa fa-minus"></i>
                                </button>
                            </td>
                            <td>
                                <input-number compCtrl="Tempo (min)" required [(ngModel)]="gradiente.tempo">
                                </input-number>
                            </td>
                            <td>
                                <input-number compCtrl="Fluxo (ml/min)" required
                                    [(ngModel)]="gradiente.fluxo">
                                </input-number>
                            </td>
                            <td>
                                <input-number compCtrl="Solvente A (%)" required
                                    [(ngModel)]="gradiente.solventeA" [max]="100" [min]="0"
                                    (onChange)="onChangeSolvente('A', gradiente)">
                                </input-number>
                            </td>
                            <td>
                                <input-number compCtrl="Solvente B (%)" required
                                    [(ngModel)]="gradiente.solventeB" [max]="100" [min]="0"
                                    (onChange)="onChangeSolvente('B', gradiente)">
                                </input-number>
                            </td>
                            <td>
                                <b>{{(gradiente.solventeA || 0) + (gradiente.solventeB || 0)}}</b>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </ng-container>

    <ng-container *ngIf="getSolicitationType() == 'COR'">
        <div class="row mb-2">
            <div class="col-24">
                <input-text label="Localização das medições" compCtrl required
                    [ngModel]="object.form.locationMed"
                    placeholder="Exemplo em frutas: medições na região lateral, superior, inferior, etc.. ">
                </input-text>
            </div>
        </div>

        <div class="row mb-2">
            <div class="col-24">
                <radio-button label="Leitura" [(ngModel)]="object.form.tipoLeitura" compCtrl required
                    enum="CORTipoLeitura" [vertical]="false">
                </radio-button>
            </div>
        </div>
    </ng-container>

    <ng-container *ngIf="getSolicitationType() == 'DRX'">
        <div class="row mb-2">
            <div class="col-24">
                <radio-button label="Modo de Análise" [(ngModel)]="object.form.modoAnalise" compCtrl required
                    enum="DRXModoAnalise" [vertical]="false">
                </radio-button>
            </div>
        </div>

        <ng-container *ngTemplateOutlet="tableDRX_TGADTA"></ng-container>
    </ng-container>

    <ng-container *ngIf="['DSC', 'TGADTA'].includes(getSolicitationType())">
        <ng-container *ngTemplateOutlet="tableDSC_TGA"></ng-container>
    </ng-container>

    <ng-container *ngIf="getSolicitationType() == 'FTMIR'">
        <div class="row mb-2">
            <div class="col-24">
                <radio-button label="Serviço Requerido" [(ngModel)]="object.form.servico" compCtrl required
                    enum="FTMIRServico">
                </radio-button>
            </div>
        </div>

        <div class="row mb-2">
            <div class="col-12">
                <input-text label="Faixa de varredura (400 a 4000 cm⁻¹)" compCtrl required
                    [(ngModel)]="object.form.faixaVarredura" [maxlength]="255">
                </input-text>
            </div>
            <div class="col-12">
                <input-number label="Resolucao (cm⁻¹)" compCtrl required [(ngModel)]="object.form.resolucao"
                    [maxlength]="4">
                </input-number>
            </div>
        </div>

        <div class="row mb-2">
            <div class="col-12">
                <radio-button label="Registros dos Espectos" [(ngModel)]="object.form.registrosEspectos"
                    compCtrl required enum="FTMIRRegistroEspectro" [vertical]="false">
                </radio-button>
            </div>
            <div class="col-12">
                <input-number label="Scans" compCtrl required [(ngModel)]="object.form.scans" [maxlength]="4">
                </input-number>
            </div>
        </div>

        <div class="row mb-2">
            <div class="col-12">
                <radio-button label="Característica" [(ngModel)]="object.form.caracteristica" compCtrl
                    required enum="FTMIREstado">
                </radio-button>
            </div>
            <div class="col-12">
                <input-text label="Solvente utilizado" compCtrl required [(ngModel)]="object.form.solvente">
                </input-text>
            </div>
        </div>
    </ng-container>

    <ng-container *ngIf="getSolicitationType() == 'MEV'">
        <ng-container *ngTemplateOutlet="tableMEV"></ng-container>
    </ng-container>

    <hr>

    <div class="row mb-2">
        <div class="col-24">
            <input-textarea label="Observações adicionais" compCtrl [(ngModel)]="object.observation"
                [maxlength]="255">
            </input-textarea>
        </div>
    </div>

    <ng-template #tableAmostrasSimples>
        <div class="row mb-2" *ngIf="object.form?.amostras">
            <div class="col-24 table-responsive">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th colspan="6">
                                <h3 class="m-0 text-center">Amostras</h3>
                            </th>
                        </tr>
                        <tr>
                            <th class="index-column">Nº</th>
                            <th *ngIf="!disableForm" class="button-column no-print"></th>
                            <th *ngIf="!disableForm" class="button-column no-print"></th>
                            <th class="">Identificação</th>
                            <th class="">Descrição</th>
                            <th class="">Quantidade de leituras por amostra</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let amostra of object.form.amostras; let index = index">
                            <td>
                                <b>{{index +1}}</b>
                            </td>
                            <td *ngIf="!disableForm" class="button-column no-print">
                                <button class="btn btn-sm btn-success" (click)="onClickAddAmostra()">
                                    <i class="fa fa-plus"></i>
                                </button>
                            </td>
                            <td *ngIf="!disableForm" class="button-column no-print">
                                <button class="btn btn-sm btn-danger" (click)="onClickRemoveAmostra(index)">
                                    <i class="fa fa-minus"></i>
                                </button>
                            </td>
                            <td>
                                <input-text compCtrl="Identificação" required
                                    [(ngModel)]="amostra.identification">
                                </input-text>
                            </td>
                            <td>
                                <input-text compCtrl="Descrição" [(ngModel)]="amostra.description">
                                </input-text>
                            </td>
                            <td>
                                <input-number compCtrl="Quantidade de leituras por amostra" required
                                    [(ngModel)]="amostra.leituras" [maxlength]="2">
                                </input-number>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </ng-template>

    <ng-template #tableAA>
        <div class="row mb-2" *ngIf="object.form?.amostras">
            <div class="col-24 table-responsive">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th colspan="6">
                                <h3 class="m-0 text-center">Amostras</h3>
                            </th>
                        </tr>
                        <tr>
                            <th class="index-column">Nº</th>
                            <th *ngIf="!disableForm" class="button-column no-print"></th>
                            <th *ngIf="!disableForm" class="button-column no-print"></th>
                            <th class="">Identificação</th>
                            <th class="">Descrição</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let amostra of object.form.amostras; let index = index">
                            <td>
                                <b>{{index +1}}</b>
                            </td>
                            <td *ngIf="!disableForm" class="button-column no-print">
                                <button class="btn btn-sm btn-success" (click)="onClickAddAmostra()">
                                    <i class="fa fa-plus"></i>
                                </button>
                            </td>
                            <td *ngIf="!disableForm" class="button-column no-print">
                                <button class="btn btn-sm btn-danger" (click)="onClickRemoveAmostra(index)">
                                    <i class="fa fa-minus"></i>
                                </button>
                            </td>
                            <td>
                                <input-text compCtrl="Identificação" required
                                    [(ngModel)]="amostra.identification">
                                </input-text>
                            </td>
                            <td>
                                <input-text compCtrl="Descrição" [(ngModel)]="amostra.description">
                                </input-text>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </ng-template>

    <ng-template #tableDRX_TGADTA>
        <div class="row mb-2">
            <div class="col-24 table-responsive">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th class="index-column">Nº</th>
                            <th *ngIf="!disableForm" class="button-column no-print"></th>
                            <th *ngIf="!disableForm" class="button-column no-print"></th>
                            <th class="min-250">Identificação</th>
                            <th class="min-250">Descrição</th>
                            <th class="min-180 text-center">Faixa de Varredura Final<br>
                                <div class="text-center">(3° - 70°)</div>
                            </th>
                            <th class="min-180">Step</th>
                            <th *ngIf="object.form.modoAnalise == MODO_ANALISE_CN"
                                class="min-180 text-center">
                                Velocidade de Varredura<br>
                                <div class="text-center">(°/min)</div>
                            </th>
                            <th *ngIf="object.form.modoAnalise == MODO_ANALISE_ST" class="min-180">
                                Tempo do passo(s)
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let amostra of object.form.amostras; let index = index"
                            class="vertical-middle">
                            <td>
                                <b>{{index +1}}</b>
                            </td>
                            <td *ngIf="!disableForm" class="button-column no-print">
                                <button class="btn btn-sm btn-success" (click)="onClickAddAmostra()">
                                    <i class="fa fa-plus"></i>
                                </button>
                            </td>
                            <td *ngIf="!disableForm" class="button-column no-print">
                                <button class="btn btn-sm btn-danger" (click)="onClickRemoveAmostra(index)">
                                    <i class="fa fa-minus"></i>
                                </button>
                            </td>
                            <td>
                                <input-text compCtrl="Identificação" required
                                    [(ngModel)]="amostra.identification">
                                </input-text>
                            </td>
                            <td>
                                <input-text compCtrl="Descrição" [(ngModel)]="amostra.description">
                                </input-text>
                            </td>
                            <td>
                                <input-text compCtrl="Faixa de Varredura Final (3° - 70°)" required
                                    [(ngModel)]="amostra.faixaVarredura" [maxlength]="255"
                                    [placeholder]="'3° - XXX'">
                                </input-text>
                            </td>
                            <td>
                                <radio-button compCtrl="Step" required enum="DRXStep"
                                    [(ngModel)]="amostra.step">
                                </radio-button>
                            </td>
                            <td *ngIf="object.form.modoAnalise == MODO_ANALISE_CN">
                                <input-number compCtrl="Velocidade de varredura (°/min)" required
                                    [(ngModel)]="amostra.velocidadeVarredura" [maxlength]="3">
                                </input-number>
                            </td>
                            <td *ngIf="object.form.modoAnalise == MODO_ANALISE_ST">
                                <input-number compCtrl="Tempo do passo(s)" required
                                    [(ngModel)]="amostra.tempoPasso" [maxlength]="3">
                                </input-number>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </ng-template>

    <ng-template #tableDSC_TGA>
        <div class="row mb-2">
            <div class="col-24 table-responsive">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th class="index-column">Nº</th>
                            <th *ngIf="!disableForm" class="button-column no-print"></th>
                            <th *ngIf="!disableForm" class="button-column no-print"></th>
                            <th class="min-250">Identificação</th>
                            <th class="min-250">Descrição</th>
                            <th class="min-180">Expande</th>
                            <th class="min-180">Libera Gás</th>
                            <th class="min-180 text-center">Massa (3 - 150mg)</th>
                            <th class="min-180" *ngIf="['DSC'].includes(getSolicitationType())">Técnica DSC
                            </th>
                            <th class="min-180 text-center">Atmosfera</th>
                            <th class="min-180 text-center">Fluxo de Gás (10 - 100 mL/min)</th>
                            <th class="min-180 text-center">Taxa de aquecimento<br>
                                <div class="text-center">(0,5 - 100 °C/min)</div>
                            </th>
                            <th class="min-180">Intervalo de temperatura (°C)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let amostra of object.form.amostras; let index = index"
                            class="vertical-middle">
                            <td>
                                <b>{{index +1}}</b>
                            </td>
                            <td *ngIf="!disableForm" class="button-column no-print">
                                <button class="btn btn-sm btn-success" (click)="onClickAddAmostra()">
                                    <i class="fa fa-plus"></i>
                                </button>
                            </td>
                            <td *ngIf="!disableForm" class="button-column no-print">
                                <button class="btn btn-sm btn-danger" (click)="onClickRemoveAmostra(index)">
                                    <i class="fa fa-minus"></i>
                                </button>
                            </td>
                            <td>
                                <input-text compCtrl="Identificação" required
                                    [(ngModel)]="amostra.identification">
                                </input-text>
                            </td>
                            <td>
                                <input-text compCtrl="Descrição" [(ngModel)]="amostra.description">
                                </input-text>
                            </td>
                            <td>
                                <radio-button compCtrl="Expande" [(ngModel)]="amostra.expande" enum="Boolean"
                                    required>
                                </radio-button>
                            </td>
                            <td>
                                <radio-button compCtrl="Libera Gás" [(ngModel)]="amostra.liberaGas"
                                    enum="Boolean" required>
                                </radio-button>
                                <input-text compCtrl="Gás Liberado" required [(ngModel)]="amostra.gasLiberado"
                                    [placeholder]="'Gás Liberado'" *ngIf="amostra.liberaGas == BOOLEAN_TRUE">
                                </input-text>
                            </td>
                            <td>
                                <input-number compCtrl="Massa (3 - 150mg)" required
                                    [(ngModel)]="amostra.massa" [min]="3" [max]="150" [maxlength]="3"
                                    [placeholder]="'(3 - 150mg)'">
                                </input-number>
                            </td>
                            <td *ngIf="['DSC'].includes(getSolicitationType())">
                                <radio-button compCtrl="Técnica DSC" required enum="DSCTecnica"
                                    [(ngModel)]="amostra.tecnica">
                                </radio-button>
                            </td>
                            <td>
                                <radio-button compCtrl="Atmosfera" required enum="DSCAtmosfera"
                                    [(ngModel)]="amostra.atmosfera">
                                </radio-button>
                            </td>
                            <td>
                                <input-number compCtrl="Fluxo de Gás (10 - 100 mL/min)" required
                                    [(ngModel)]="amostra.fluxoGas" [min]="10" [max]="100" [maxlength]="3"
                                    [placeholder]="'(10 - 100 mL/min)'">
                                </input-number>
                            </td>
                            <td>
                                <input-number compCtrl="Taxa de aquecimento (0,5 - 100 °C/min)" required
                                    [(ngModel)]="amostra.taxaAquecimento" [min]="0.5" [max]="100"
                                    [maxlength]="6" [maxFractionDigits]="1"
                                    [placeholder]="'(0,5 - 100 °C/min)'">
                                </input-number>
                            </td>
                            <td>
                                <input-text compCtrl="Intervalo de temperatura (°C)" required
                                    [(ngModel)]="amostra.intervaloTemperatura" [maxlength]="255"
                                    [placeholder]="'30 - XXX'">
                                </input-text>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div>
                <b class="bg-warning px-2">Indicar se a substância possui ou pode liberar agentes explosivos
                    e/ou
                    corrosivos. <br>Ex. composto com grupos Nitros ou Azidas, que liberem F-, Cl-,
                    CN- e outros.
                </b>
            </div>
        </div>
    </ng-template>

    <ng-template #tableMEV>
        <div class="row mb-2">
            <div class="col-24 table-responsive">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th colspan="6">
                                <h3 class="m-0 text-center">Amostras</h3>
                            </th>
                        </tr>
                        <tr>
                            <th class="index-column">Nº</th>
                            <th *ngIf="!disableForm" class="button-column no-print"></th>
                            <th *ngIf="!disableForm" class="button-column no-print"></th>
                            <th class="">Identificação</th>
                            <th class="">Descrição</th>
                            <th class="">Tipo de Amostra</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let amostra of object.form.amostras; let index = index">
                            <td>
                                <b>{{index +1}}</b>
                            </td>
                            <td *ngIf="!disableForm" class="button-column no-print">
                                <button class="btn btn-sm btn-success" (click)="onClickAddAmostra()">
                                    <i class="fa fa-plus"></i>
                                </button>
                            </td>
                            <td *ngIf="!disableForm" class="button-column no-print">
                                <button class="btn btn-sm btn-danger" (click)="onClickRemoveAmostra(index)">
                                    <i class="fa fa-minus"></i>
                                </button>
                            </td>
                            <td>
                                <input-text compCtrl="Identificação" required
                                    [(ngModel)]="amostra.identification">
                                </input-text>
                            </td>
                            <td>
                                <input-text compCtrl="Descrição" [(ngModel)]="amostra.description">
                                </input-text>
                            </td>
                            <td>
                                <input-text compCtrl="Tipo de Amostra" required
                                    [(ngModel)]="amostra.tipoAmostra">
                                </input-text>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </ng-template>

    <ng-container *ngIf="object?.form?.amostras?.length > 0 && !!object.solicitationType">
        <h3 class="m-0 text-center">Informações adicionais das Amostras</h3>
        <p-accordion #accordion class="w-full" expandIcon="fa fa-plus" collapseIcon="fa fa-minus"
            [multiple]="true" [activeIndex]="activeIndexAmostras">
            <p-accordionTab *ngFor="let amostra of object.form.amostras; let index = index">

                <ng-template pTemplate="header">
                    Amostra nº {{index +1}}
                    @if(!disableForm && object.form.amostras.length > 1) {
                    <button class="btn btn-sm float-right" ngxTooltip="Replicar Dados" arrow
                        (click)="onClickReplicarDadosAmostras(index)">
                        <i class="far fa-copy">
                        </i>
                    </button>
                    } @else if (disableForm) {
                    <span>&nbsp;-&nbsp;Analises:&nbsp;{{amostra.analises?.length || 0}}</span>
                    }
                </ng-template>

                @if(disableForm) {
                <p-tabView>
                    <p-tabPanel #tabAmostra header="Amostra">
                        <ng-container *ngTemplateOutlet="formularioTabelas; context: {$implicit: amostra}">
                        </ng-container>
                    </p-tabPanel>

                    <p-tabPanel #tabAnalise header="Analise">
                        <ng-container
                            *ngTemplateOutlet="tabelaAnalise; context: {$implicit: amostra, index: index}">
                        </ng-container>
                    </p-tabPanel>
                </p-tabView>
                } @else {
                <ng-container *ngTemplateOutlet="formularioTabelas; context: {$implicit: amostra}">
                </ng-container>
                }
            </p-accordionTab>
        </p-accordion>
    </ng-container>

    <ng-template #tabelaAnalise let-amostra let-amostraIndex="index">
        <div class="row" *ngIf="object.status == status_ANALYZING">
            <div class="col-12">
                <h3 *ngIf="amostra.concluida">
                    Análise da amostra finalizada
                </h3>
                <button *ngIf="isAdmin && !amostra.concluida" class="btn btn-sm btn-purple"
                    (click)="onClickAddAnalise(amostra)">
                    <i class="fa fa-plus"></i>&nbsp;Adicionar Análise
                </button>
            </div>
            <div class="col-12 text-right" *ngIf="isAdmin">
                @if (!amostra.concluida) {
                <button class="btn btn-sm btn-success me-2" *ngIf="amostra.analises.length > 0"
                    [disabled]="!isAmostraAnalisesValidToSave(amostra)"
                    (click)="onClickSalvarAnalise(amostra)">
                    <i class="fa fa-download"></i>&nbsp;Salvar Análises
                </button>
                <button class="btn btn-sm btn-primary" [disabled]="possuiAnaliseDatafimNaoPreenchida(amostra)"
                    (click)="onClickFinalizarAmostra(amostra)">
                    <i class="fa fa-lock"></i>&nbsp;Finalizar Análise
                </button>
                } @else {
                <button class="btn btn-sm btn-primary" (click)="onClickFinalizarAmostra(amostra)">
                    <i class="fa fa-unlock"></i>&nbsp;Retomar Análise
                </button>
                }
            </div>
        </div>

        <div class="row">
            <div class="col-24 table-responsive px-0" [ngStyle]="{
                'min-height.px': 40.8 + (50.4 * amostra.analises.length) + 245,
        }">
                @if (amostra.analises.length == 0) {
                <h3>Nenhuma análise foi realizada até o momento.</h3>
                } @else {
                <table class="table table-striped long-table">
                    <thead>
                        <tr>
                            <th style="min-width: 46px">#</th>
                            <th style="width: 10px;" *ngIf="!amostra.concluida || !isAdmin"></th>
                            <th style="min-width: 150px;">Inicio</th>
                            <th style="min-width: 150px;">Fim</th>
                            <th style="min-width: 300px;">Equipamento</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let analise of amostra.analises; let index = index">
                            <td class="align-middle bold">
                                {{index +1}}
                                <i class="fa fa-info-circle text-info" [ngxTooltip]="'Análise não foi salva'"
                                    *ngIf="analise.id == null">
                                </i>
                            </td>
                            <td *ngIf="!amostra.concluida || !isAdmin">
                                <button class="btn btn-sm btn-danger"
                                    (click)="onClickRemoveAnalise(amostra, index)">
                                    <i class="fa fa-times"></i>
                                </button>
                            </td>
                            <td>
                                <datepicker [disabled]="amostra.concluida|| !isAdmin"
                                    [compCtrl]="'Amostra ' + amostraIndex + 1 + ' - Data/Hora Inicial'"
                                    required [(ngModel)]="analise.dataini" [showTime]="true"
                                    [ignoreInternalDisabled]="true" (onChange)="onChangeDatas(analise)">
                                </datepicker>
                            </td>
                            <td>
                                <datepicker [disabled]="amostra.concluida || !isAdmin"
                                    [compCtrl]="'Amostra ' + amostraIndex + 1 + ' - Data/Hora Final'"
                                    [(ngModel)]="analise.datafin" [showTime]="true"
                                    [ignoreInternalDisabled]="true" (onChange)="onChangeDatas(analise)">
                                </datepicker>
                            </td>
                            <td>
                                <combobox [compCtrl]="'Amostra ' + amostraIndex + 1 + ' - Equipamento'"
                                    required [filterBy]="'id,name,shortname'"
                                    [options]="analise.id == null ? equipamentosDisponiveis : equipamentos"
                                    [(ngModel)]="analise.equipment"
                                    [disabled]="analise.id != null || !isAdmin">
                                </combobox>
                            </td>
                        </tr>
                    </tbody>
                </table>
                }
            </div>
        </div>

    </ng-template>

    <ng-template #formularioTabelas let-amostra>
        <div class="table-responsive">
            <ng-container *ngIf="['AA'].includes(getSolicitationType())">
                <table class="table table-bordered table-striped">
                    <thead>
                        <tr>
                            <th>Identificação</th>
                            <th>Descrição</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <input-text compCtrl="Identificação" required disabled
                                    [ngModel]="amostra.identification">
                                </input-text>
                            </td>
                            <td>
                                <input-text compCtrl="Descrição" disabled [ngModel]="amostra.description">
                                </input-text>
                            </td>
                        </tr>
                        <ng-container
                            *ngTemplateOutlet="posFormularioRetirada; context: {$implicit: amostra}"></ng-container>
                    </tbody>
                </table>
            </ng-container>

            <ng-container *ngIf="['AA', 'AW', 'CLAE', 'COR', 'FTMIR'].includes(getSolicitationType())">
                <table class="table table-bordered table-striped">
                    <thead>
                        <tr>
                            <th>Identificação</th>
                            <th>Descrição</th>
                            <th>Quantidade de leituras por amostra</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <input-text compCtrl="Identificação" required disabled
                                    [ngModel]="amostra.identification">
                                </input-text>
                            </td>
                            <td>
                                <input-text compCtrl="Descrição" disabled [ngModel]="amostra.description">
                                </input-text>
                            </td>
                            <td>
                                <input-number compCtrl="Quantidade de leituras por amostra" required disabled
                                    [ngModel]="amostra.leituras" [maxlength]="2">
                                </input-number>
                            </td>
                        </tr>
                        <ng-container
                            *ngTemplateOutlet="posFormularioRetirada; context: {$implicit: amostra}"></ng-container>
                    </tbody>
                </table>
            </ng-container>

            <ng-container *ngIf="['DRX'].includes(getSolicitationType())">
                <table class="table table-bordered table-striped">
                    <thead>
                        <tr>
                            <th class="min-250">Identificação</th>
                            <th class="min-250">Descrição</th>
                            <th class="min-250">Faixa de Varredura Final (3° - 70°)</th>
                            <th class="min-180">Step</th>
                            <th *ngIf="object.form.modoAnalise == MODO_ANALISE_CN" class="min-250">
                                Velocidade de Varredura (°/min)
                            </th>
                            <th *ngIf="object.form.modoAnalise == MODO_ANALISE_ST" class="min-250">
                                Tempo do passo(s)
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <input-text compCtrl="Identificação" required disabled
                                    [ngModel]="amostra.identification">
                                </input-text>
                            </td>
                            <td>
                                <input-text compCtrl="Descrição" disabled [ngModel]="amostra.description">
                                </input-text>
                            </td>
                            <td>
                                <input-text compCtrl="Faixa de Varredura Final (3° - 70°)" required
                                    [ngModel]="amostra.faixaVarredura" disabled [placeholder]="'3° - XXX'">
                                </input-text>
                            </td>
                            <td>
                                <radio-button compCtrl="Step" required enum="DRXStep" [ngModel]="amostra.step"
                                    [vertical]="false" disabled>
                                </radio-button>
                            </td>
                            <td *ngIf="object.form.modoAnalise == MODO_ANALISE_CN">
                                <input-number compCtrl="Velocidade de varredura (°/min)" required
                                    [ngModel]="amostra.velocidadeVarredura" disabled>
                                </input-number>
                            </td>
                            <td *ngIf="object.form.modoAnalise == MODO_ANALISE_ST">
                                <input-number compCtrl="Tempo do passo(s)" required
                                    [ngModel]="amostra.tempoPasso" disabled>
                                </input-number>
                            </td>
                        </tr>
                        <ng-container
                            *ngTemplateOutlet="posFormularioRetirada; context: {$implicit: amostra}"></ng-container>
                    </tbody>
                </table>
            </ng-container>

            <ng-container *ngIf="['DSC', 'TGADTA'].includes(getSolicitationType())">
                <table class="table table-bordered table-striped">
                    <thead>
                        <tr>
                            <th class="min-250">Identificação</th>
                            <th class="min-250">Descrição</th>
                            <th class="min-180">Expande</th>
                            <th class="min-180">Libera Gás</th>
                            <th class="min-180 text-center">Massa (3 - 150mg)</th>
                            <th class="min-180">Técnica DSC</th>
                            <th class="min-180 text-center">Atmosfera</th>
                            <th class="min-180 text-center">Fluxo de Gás (10 - 100 mL/min)
                            </th>
                            <th class="min-180 text-center">Taxa de aquecimento<br>
                                <div class="text-center">(0,5 - 100 °C/min)</div>
                            </th>
                            <th class="min-180">Intervalo de temperatura (°C)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <input-text compCtrl="Identificação" required disabled
                                    [ngModel]="amostra.identification">
                                </input-text>
                            </td>
                            <td>
                                <input-text compCtrl="Descrição" disabled [ngModel]="amostra.description">
                                </input-text>
                            </td>
                            <td>
                                <radio-button compCtrl="Expande" [ngModel]="amostra.expande" enum="Boolean"
                                    required disabled>
                                </radio-button>
                            </td>
                            <td>
                                <radio-button compCtrl="Libera Gás" [ngModel]="amostra.liberaGas"
                                    enum="Boolean" required disabled>
                                </radio-button>
                                <input-text compCtrl="Gás Liberado" required disabled
                                    [ngModel]="amostra.gasLiberado" [placeholder]="'Gás Liberado'"
                                    *ngIf="amostra.liberaGas == BOOLEAN_TRUE">
                                </input-text>
                            </td>
                            <td>
                                <input-number compCtrl="Massa (3 - 150mg)" required disabled
                                    [ngModel]="amostra.massa" [min]="3" [max]="150" [maxlength]="3"
                                    [placeholder]="'(3 - 150mg)'">
                                </input-number>
                            </td>
                            <td>
                                <radio-button compCtrl="Técnica DSC" required disabled enum="DSCTecnica"
                                    [ngModel]="amostra.tecnica">
                                </radio-button>
                            </td>
                            <td>
                                <radio-button compCtrl="Atmosfera" required disabled enum="DSCAtmosfera"
                                    [ngModel]="amostra.atmosfera">
                                </radio-button>
                            </td>
                            <td>
                                <input-number compCtrl="Fluxo de Gás (10 - 100 mL/min)" required disabled
                                    [ngModel]="amostra.fluxoGas" [min]="10" [max]="100" [maxlength]="3"
                                    [placeholder]="'(10 - 100 mL/min)'">
                                </input-number>
                            </td>
                            <td>
                                <input-number compCtrl="Taxa de aquecimento (0,5 - 100 °C/min)" required
                                    disabled [ngModel]="amostra.taxaAquecimento" [min]="0.5" [max]="100"
                                    [maxlength]="6" [maxFractionDigits]="1"
                                    [placeholder]="'(0,5 - 100 °C/min)'">
                                </input-number>
                            </td>
                            <td>
                                <input-number compCtrl="Intervalo de temperatura (°C)" required disabled
                                    [ngModel]="amostra.intervaloTemperatura" [min]="30" [maxlength]="6"
                                    [placeholder]="'30 - XXX'" [maxFractionDigits]="2">
                                </input-number>
                            </td>
                        </tr>
                        <ng-container
                            *ngTemplateOutlet="posFormularioRetirada; context: {$implicit: amostra}"></ng-container>
                    </tbody>
                </table>
            </ng-container>

            <ng-container *ngIf="['MEV'].includes(getSolicitationType())">
                <table class="table table-bordered table-striped">
                    <thead>
                        <tr>
                            <th>Identificação</th>
                            <th>Descrição</th>
                            <th>Tipo de Amostra</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <input-text compCtrl="Identificação" required disabled
                                    [ngModel]="amostra.identification">
                                </input-text>
                            </td>
                            <td>
                                <input-text compCtrl="Descrição" disabled [ngModel]="amostra.description">
                                </input-text>
                            </td>
                            <td>
                                <input-text compCtrl="Tipo de Amostra" required disabled
                                    [(ngModel)]="amostra.tipoAmostra">
                                </input-text>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="99">
                                <div class="row mb-2">
                                    <div class="col-24">
                                        <div class="row mb-2">
                                            <div class="col-24">
                                                <input-textarea label="Objetivo da Análise" compCtrl
                                                    [(ngModel)]="amostra.objetivo" [maxlength]="255">
                                                </input-textarea>
                                            </div>
                                        </div>

                                        <div class="row mb-2">
                                            <div class="col-24 table-responsive">
                                                <table class="table table-striped">
                                                    <thead>
                                                        <tr>
                                                            <th class="index-column">Nº
                                                            </th>
                                                            <th *ngIf="!disableForm"
                                                                class="button-column no-print">
                                                            </th>
                                                            <th *ngIf="!disableForm"
                                                                class="button-column no-print">
                                                            </th>
                                                            <th class="">Aproximações
                                                                desejadas (50x - 2000x)
                                                            </th>
                                                            <th class="">Quantidade de
                                                                fotos por aproximação</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr
                                                            *ngFor="let foto of amostra.fotos; let indexMev = index">
                                                            <td>
                                                                <b>{{indexMev +1}}</b>
                                                            </td>
                                                            <td *ngIf="!disableForm"
                                                                class="button-column no-print">
                                                                <button class="btn btn-sm btn-success"
                                                                    (click)="onClickAddFotoMev(amostra)">
                                                                    <i class="fa fa-plus"></i>
                                                                </button>
                                                            </td>
                                                            <td *ngIf="!disableForm"
                                                                class="button-column no-print">
                                                                <button class="btn btn-sm btn-danger"
                                                                    (click)="onClickRemoveFotoMev(amostra, indexMev)">
                                                                    <i class="fa fa-minus"></i>
                                                                </button>
                                                            </td>
                                                            <td>
                                                                <input-number
                                                                    compCtrl="Aproximações desejadas" required
                                                                    [(ngModel)]="foto.aproximacoes" [min]="50"
                                                                    [max]="2000" [maxlength]="4">
                                                                </input-number>
                                                            </td>
                                                            <td>
                                                                <input-number
                                                                    compCtrl="Quantidade de fotos por aproximação"
                                                                    required
                                                                    [(ngModel)]="foto.qtdFotosAproximacao"
                                                                    [min]="1">
                                                                </input-number>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>

                                        <div class="row mb-2">
                                            <div class="col-24">
                                                <uploadfile [label]="'Imagem modelo de microscopia'"
                                                    [(ngModel)]="amostra.modeloMicroscopia" [multiple]="false"
                                                    [bucket]="getBucketName()"
                                                    [uploader]="amostra.modeloMicroscopia == null"
                                                    [disabled]="objectUpdating()">
                                                </uploadfile>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <ng-container
                            *ngTemplateOutlet="posFormularioRetirada; context: {$implicit: amostra}"></ng-container>
                    </tbody>
                </table>
            </ng-container>
        </div>
    </ng-template>

    <ng-template #posFormularioRetirada let-amostra>
        <tr>
            <td colspan="99">
                <div class="row mb-2">
                    <div class="col-24">
                        <ol>
                            <li class="mb-2">
                                <b>COMPOSIÇÃO</b>
                                <div class="row mb-2">
                                    <div class="col-24">
                                        <ol type="a">
                                            <li class="mb-2">
                                                <input-text label="Composição da Amostra" compCtrl required
                                                    [(ngModel)]="amostra.composicao">
                                                </input-text>
                                            </li>
                                            <li class="mb-2">
                                                <radio-button label="É tóxica?" compCtrl
                                                    [(ngModel)]="amostra.toxic" enum="Boolean" required
                                                    [vertical]="false">
                                                </radio-button>
                                            </li>
                                        </ol>
                                    </div>
                                </div>
                            </li>
                            <li *ngIf="object.form.retirada == BOOLEAN_FALSE">
                                <div class="row mb-2">
                                    <div class="col-24">
                                        <radio-button label="Natureza da Amostra" compCtrl required
                                            [(ngModel)]="amostra.naturezaAmostra" enum="NaturezaAmostra"
                                            (onChange)="onChangeNaturezaAmostra()">
                                        </radio-button>
                                    </div>
                                </div>

                                <div class="row mb-2">
                                    <div class="col-24 table-responsive">
                                        <table class="table table-striped table-bordered">
                                            <tbody>
                                                <tr
                                                    *ngIf="amostra.naturezaAmostra == NATUREZA_ORGANICA_ORGANICA">
                                                    <td colspan="2">
                                                        <radio-button [(ngModel)]="amostra.descarteOrganico"
                                                            enum="DescarteOrganico"
                                                            compCtrl="Descartes - Orgânico" required
                                                            (onChange)="onChangeDescarteOrganico()">
                                                        </radio-button>
                                                        <input-text label="Outro" compCtrl required
                                                            *ngIf="amostra.descarteOrganico == OPCAO_OUTRO"
                                                            [(ngModel)]="amostra.descarteOrganicoOutro">
                                                        </input-text>
                                                    </td>
                                                </tr>
                                                <tr
                                                    *ngIf="amostra.naturezaAmostra == NATUREZA_ORGANICA_INORGANICA">
                                                    <td colspan="2">
                                                        <radio-button [(ngModel)]="amostra.descarteInorganico"
                                                            enum="DescarteInorganico"
                                                            compCtrl="Descartes - Inorgânico" required
                                                            (onChange)="onChangeDescarteInorganico()">
                                                        </radio-button>
                                                        <input-text label="Outro" compCtrl required
                                                            *ngIf="amostra.descarteInorganico == OPCAO_OUTRO"
                                                            [(ngModel)]="amostra.descarteInorganicoOutro">
                                                        </input-text>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        Recomendação de
                                                        descarte
                                                        pelo usuário
                                                        <radio-button [(ngModel)]="amostra.descarteUsuario"
                                                            enum="DescarteUsuario"
                                                            compCtrl="Descartes - Usuário" required
                                                            (onChange)="onChangeDescarteUsuario()">
                                                        </radio-button>
                                                        <input-textarea label="Outro" compCtrl required
                                                            *ngIf="amostra.descarteUsuario == OPCAO_OUTRO"
                                                            [(ngModel)]="amostra.descarteUsuarioOutro">
                                                        </input-textarea>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </li>
                        </ol>
                    </div>
                </div>
            </td>
        </tr>
    </ng-template>
</ng-container>

}
